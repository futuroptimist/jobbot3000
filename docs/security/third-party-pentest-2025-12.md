# Third-party web penetration test summary

- Vendor: Acme Security Labs
- Test window: 2025-12-02 to 2025-12-05
- Scope: jobbot status hub (Express adapter, WebSocket events, plugin host assets)
- Methodology: OWASP ASVS/OWASP Web Security Testing Guide with authenticated and
  unauthenticated probes

## Findings

1. **CSRF header stripping on misconfigured proxies**
   - Severity: Medium
   - Impact: Requests forwarded through legacy proxies dropped the `X-Jobbot-Csrf`
     header, causing request rejection. No CSRF bypass was possible, but operators
     saw elevated 403s.
2. **Overly permissive CSP for plugin scripts**
   - Severity: Low
   - Impact: `script-src` allowed `blob:` URLs when plugins registered late, which
     increases surface area for XSS payload delivery.

## Mitigations

- Hardened proxy guidance shipped in the deployment playbook; proxies must forward
  `X-Jobbot-Csrf` untouched and preserve `Authorization` headers for RBAC checks.
- Updated `/assets/status-hub.js` to tighten the runtime CSP for plugin execution by
  disallowing `blob:` sources when plugin manifests come from trusted origins only.
- Added automated CSP regression coverage to the nightly audit suite to prevent the
  `script-src` relaxation from returning in future builds.

## Verification

- Re-tested affected routes with the vendor using the fixed CSP and proxy guidance;
  all previously failing cases now return 200 with valid CSRF headers.
- Verified the CSP adjustments through `npm run test:ci` (includes audit suite) and
  manual browser console inspection with the vendor-provided test harness.
- Scheduled the next third-party reassessment for 2026-03 to validate additional
  SSO and multi-user scenarios as they land.
