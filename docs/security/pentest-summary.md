# Web penetration test summary

Test window: 2025-11-02 → 2025-11-05 (internal red team dry run for web status hub)

## Scope

- `startWebServer` Express app (authenticated command adapter endpoints, static assets, payload history)
- Session manager, CSRF middleware, and payload sanitation pipeline
- Docker/runtime hardening options defined in [`docker-compose.web.yml`](../../docker-compose.web.yml)

## Findings

- **High:** Missing alerting on repeated CSRF failures allowed brute-force attempts to go undetected despite generating numerous failed requests.
- **Medium:** Payload history endpoint exposed request timestamps without jitter, enabling traffic
  correlation across tenants if encryption keys were compromised.
- **Low:** Reminders export endpoint did not rate-limit ICS downloads when using mocked adapters.

## Mitigations

- Added telemetry hook for CSRF failure streaks; surfaced to security dashboards for alerting.
- Salted and jittered payload history timestamps (±750ms) before encryption to limit correlation
  value while preserving event ordering.
- Applied per-identity rate limiting to reminders export handlers even when adapters are mocked.
- Automated on-call alert delivery: `startWebServer` now reads `JOBBOT_WEB_ONCALL_EMAILS` (or an
  explicit `securityAlerts.rotation` list) and writes `.eml` notifications to `data/alerts/`
  (override with `JOBBOT_WEB_ALERT_OUTBOX`) whenever CSRF, auth, or rate-limit security events are
  logged. Alerts link directly to `docs/web-operational-playbook.md` for escalation steps. Regression
  coverage in [`test/web-security-alerts.test.js`](../../test/web-security-alerts.test.js) drives a
  CSRF failure to ensure on-call notifications are emitted.

## Verification

- Regression suite expanded ([`test/web-security-roadmap-doc.test.js`](../../test/web-security-roadmap-doc.test.js)) to keep the summary anchored to the roadmap and validate section scaffolding.
- Manual replay of exploit scripts confirmed mitigations emit alerts and throttle repeated downloads.
- Spot-checked payload history ciphertext to confirm timestamp jitter is stored post-sanitization.

## Next actions

- Schedule external vendor-led retest before enabling multi-tenant pilots.
